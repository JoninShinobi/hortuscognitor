{% extends 'base.html' %}
{% load static %}

{% block title %}{{ course.title }} - Hortus Cognitor{% endblock %}

{% block content %}
<section class="hero course-hero" {% if course.hero_image %}style="background: linear-gradient(rgba(26, 26, 26, 0.7), rgba(42, 42, 42, 0.7)), url('{{ course.hero_image.url }}'); background-size: cover; background-position: center; background-attachment: fixed;"{% endif %}>
    <div class="hero-logo">
        <img src="{% static 'images/CARROTFIST_white.png' %}" alt="Hortus Cognitor Logo">
    </div>
    <div class="container">
        <div class="hero-content">
            <h1>{{ course.title }}</h1>
            <div style="margin-top: 2rem; color: white; text-align: center; white-space: nowrap;">
                <span style="margin-right: 2rem;">üìÖ Starts: {{ course.start_date|date:"F Y" }}</span>
                <span style="margin-right: 2rem;">‚è± Duration: {{ course.duration }}</span>
                <span style="margin-right: 2rem;">üë• Max Participants: {{ course.max_participants }}</span>
                <span style="font-weight: bold; color: #ADA228;">Spaces Left: {{ course.spaces_left }}</span>
            </div>
            {% if course.sessions.exists %}
            <div style="margin-top: 1rem; text-align: center;">
                <button onclick="toggleSessionsDropdown()" class="sessions-toggle" style="background: transparent; border: 1px solid white; color: white; padding: 0.5rem 1.5rem; cursor: pointer; border-radius: 4px; font-size: 1rem;">View Course Dates</button>
            </div>
            <div id="sessions-dropdown" class="sessions-dropdown" style="display: none; margin-top: 1rem; background: rgba(0, 0, 0, 0.3); color: white; padding: 1rem; border-radius: 8px; max-width: 400px; margin-left: auto; margin-right: auto;">
                <h3 style="font-family: 'hey-eloise', 'Kalam', 'Patrick Hand', 'Caveat', cursive; color: #ADA228; font-size: 1.2rem; margin-bottom: 0.75rem; text-align: left;">Course Sessions</h3>
                {% for session in course.sessions.all %}
                <div style="padding: 0.5rem 0; border-bottom: 1px solid rgba(255, 255, 255, 0.2); {% if forloop.last %}border-bottom: none;{% endif %}; text-align: left; font-size: 0.9rem;">
                    <strong style="color: #ADA228;">Session {{ session.session_number }}:</strong>
                    {{ session.date|date:"l, j F Y" }} | {{ session.start_time|time:"H:i" }} - {{ session.end_time|time:"H:i" }}
                </div>
                {% endfor %}
            </div>
            {% endif %}
        </div>
    </div>
</section>

<section class="course-detail">
    <div class="container">
        <div class="course-info-grid">
        <div class="course-content">
            {% if course.description %}
            <h2>About This Course</h2>
            <div style="color: #ffffff;">{{ course.description|linebreaks }}</div>
            {% endif %}

            {% if course.what_you_will_experience %}
            <h2>What You Will Experience</h2>
            <div style="color: #ffffff;">{{ course.what_you_will_experience|linebreaks }}</div>
            {% endif %}

            {% if course.course_structure %}
            <h2>Course Structure</h2>
            <div style="color: #ffffff;">{{ course.course_structure|linebreaks }}</div>
            {% endif %}

            {% if course.location %}
            <h2>Location</h2>
            <div style="color: #ffffff;">{{ course.location|linebreaks }}</div>
            {% endif %}

            {% if course.accessibility %}
            <h2>Accessibility</h2>
            <div style="color: #ffffff;">{{ course.accessibility|linebreaks }}</div>
            {% endif %}

            {% if course.who_this_is_for %}
            <h2>Who This Is For</h2>
            <div style="color: #ffffff;">{{ course.who_this_is_for|linebreaks }}</div>
            {% endif %}

            {% if course.what_you_will_gain %}
            <h2>What You Will Gain</h2>
            <div style="color: #ffffff;">{{ course.what_you_will_gain|linebreaks }}</div>
            {% endif %}
        </div>

        <div class="course-sidebar">
            <!-- White background section with pricing -->
            <div style="background: white; padding: 2rem; border-radius: 8px; margin-bottom: 2rem;">
                <h4 style="font-family: 'hey-eloise', cursive; color: #ADA228; font-size: 1.5rem; margin-bottom: 1rem; text-align: center;">Pricing</h4>
                <p style="color: #000000; font-size: 0.9rem; text-align: center; margin-bottom: 1.5rem;">Choose what feels right for your situation</p>

                <div style="text-align: center; margin-bottom: 1rem;">
                    <div style="margin-bottom: 0.5rem;">
                        <strong style="color: #000000;">¬£225 - ¬£475</strong>
                    </div>
                </div>

                <p style="font-size: 0.9rem; color: #000000; margin-bottom: 1.5rem; text-align: center;">Limited to {{ course.max_participants }} participants</p>
                
                <div style="text-align: center;">
                    <a href="{% url 'payment_selection' course.slug %}" class="btn" style="background: #ADA228; color: white; text-decoration: none; padding: 1rem 2rem; display: inline-block; border-radius: 4px; font-size: 1.1rem; margin-bottom: 1rem;">
                        View Pricing & Book
                    </a>
                </div>
            </div>
        </div>
    </div>
    </div>
</section>

<script>
function toggleSessionsDropdown() {
    const dropdown = document.getElementById('sessions-dropdown');
    if (dropdown.style.display === 'none') {
        dropdown.style.display = 'block';
    } else {
        dropdown.style.display = 'none';
    }
}
</script>
{% endblock %}